import"server-only";var $=async(e,s,t)=>{try{let n=await(await fetch(t?.customEndpoint?`${t?.customEndpoint}/${e}/${s}`:`https://farcaster.tv/${e}/${s}`)).json();return n.result.casts[2]&&n.result.casts[2].author.username===e&&n.result.casts[2].hash.includes(s)?n.result.casts[2]:n.result.casts[0].castType==="root-embed"?n.result.casts[1]:n.result.casts[0]}catch(i){throw console.error(i),new Error(`Unable to fetch cast ${s} by ${e}.${t?.customEndpoint&&" You are using a custom endpoint ("+t?.customEndpoint+"). Make sure it is correct and the server is running. For more info about the proxy server check the README."}`)}};import D from"linkify-react";import{jsx as m,jsxs as E}from"react/jsx-runtime";var U=()=>m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:m("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),H=()=>E("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[m("path",{d:"M17 2.1l4 4-4 4"}),m("path",{d:"M3 12.2v-2a4 4 0 0 1 4-4h12.8M7 21.9l-4-4 4-4"}),m("path",{d:"M21 11.8v2a4 4 0 0 1-4 4H4.2"})]}),M=()=>m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:m("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),_=()=>m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:m("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),F=()=>E("svg",{width:"24",height:"24",viewBox:"0 0 1260 1260",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[E("g",{clipPath:"url(#fc-embed-clip1)",children:[m("path",{d:"M947.747 1259.61H311.861C139.901 1259.61 0 1119.72 0 947.752V311.871C0 139.907 139.901 0.00541362 311.861 0.00541362H947.747C1119.71 0.00541362 1259.61 139.907 1259.61 311.871V947.752C1259.61 1119.72 1119.71 1259.61 947.747 1259.61Z",fill:"#472A91"}),m("path",{d:"M826.513 398.633L764.404 631.889L702.093 398.633H558.697L495.789 633.607L433.087 398.633H269.764L421.528 914.36H562.431L629.807 674.876L697.181 914.36H838.388L989.819 398.633H826.513Z",fill:"white"})]}),m("defs",{children:m("clipPath",{id:"fc-embed-clip1",children:m("rect",{width:"1259.61",height:"1259.61",fill:"white"})})})]});import{jsx as I}from"react/jsx-runtime";function C({images:e}){return I("div",{className:"farcaster-embed-image-container",children:e.map(s=>I("a",{href:s.url,target:"_blank",className:"farcaster-embed-image-link",children:I("img",{src:s.url,alt:s.alt,className:"farcaster-embed-image"})},s.url))})}import x from"react";import{jsx as R}from"react/jsx-runtime";function O({source:e,poster:s,aspectRatio:t}){let[i,n]=x.useState(!1),[u,h]=x.useState(!1),y=d=>new Promise((g,p)=>{let l=document.createElement("script");l.src=d,l.type="module",l.onload=()=>g(l),l.onerror=()=>p(new Error(`[react-farcaster-embed] Script load error for ${d}`)),document.head.appendChild(l)});return x.useEffect(()=>{let d="scripts/media-chrome.js",g="scripts/hls-video-element.js";return y(d).then(()=>{n(!0)}).catch(p=>{console.error("Media Chrome loading failed",p)}),y(g).then(()=>{h(!0)}).catch(p=>{console.error("HLS Video Element loading failed",p)}),()=>{document.head.removeChild(document.head.querySelector(`script[src="${d}"]`)),document.head.removeChild(document.head.querySelector(`script[src="${g}"]`))}},[e,s,t]),R("div",{style:{aspectRatio:t},children:i&&u&&R("div",{className:"farcaster-embed-video-player",dangerouslySetInnerHTML:{__html:`<media-controller>
            <hls-video
              src="${e}"
              slot="media"
              volume="1"
              crossorigin
              playsinline
            ></hls-video>
            <media-poster-image
              slot="poster"
              src="${s}">
            </media-poster-image>
            <media-loading-indicator slot="centered-chrome" noautohide></media-loading-indicator>
            <media-control-bar>
              <media-play-button></media-play-button>
              <media-time-range></media-time-range>
              <media-time-display showduration remaining></media-time-display>
              <media-fullscreen-button></media-fullscreen-button>
            </media-control-bar>
          </media-controller>`}})})}import{jsx as P}from"react/jsx-runtime";function W({source:e,poster:s,aspectRatio:t}){return P("div",{style:{aspectRatio:t},children:P("div",{className:"farcaster-embed-video-player",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:`<script type="module" src="../../scripts/media-chrome.js" crossorigin="anonymous"></script><script type="module" src="../../scripts/hls-video-element.js" crossorigin="anonymous"></script><media-controller>
            <hls-video
              src="${e}"
              slot="media"
              volume="1"
              crossorigin
              playsinline
            ></hls-video>
            <media-poster-image
              slot="poster"
              src="${s}">
            </media-poster-image>
            <media-loading-indicator slot="centered-chrome" noautohide></media-loading-indicator>
            <media-control-bar>
              <media-play-button></media-play-button>
              <media-time-range></media-time-range>
              <media-time-display showduration remaining></media-time-display>
              <media-fullscreen-button></media-fullscreen-button>
            </media-control-bar>
          </media-controller>`}})})}import{jsx as S}from"react/jsx-runtime";function V({videos:e,client:s}){return S("div",{className:"farcaster-embed-video-container",children:e.map(t=>s?S(O,{source:t.sourceUrl,aspectRatio:t.width/t.height,poster:t.thumbnailUrl},t.url):S(W,{source:t.sourceUrl,aspectRatio:t.width/t.height,poster:t.thumbnailUrl},t.url))})}import{jsx as a,jsxs as r}from"react/jsx-runtime";var B={className:"farcaster-embed-body-link",target:"_blank"};function ee(e,s){if(e.endsWith(s)){let t=e.lastIndexOf(s),i=e.substring(0,t),n=i.lastIndexOf(`
`);return n!==-1&&(i=i.substring(0,n)+i.substring(n+1)),i+e.substring(t+s.length)}else return e}function T({cast:e,client:s,options:t}){let i=e.author,n=`https://warpcast.com/~/profiles/${i.fid}`,u=new Date(e.timestamp),h=u.toLocaleString(t.timestampLocale,t.timestampFormat),y=u.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0}),d=`https://warpcast.com/${i.username}/${e.hash}`,g=e.replies&&e.replies.count,p=e.reactions&&e.reactions.count,l=e.combinedRecastCount?e.combinedRecastCount:e.recasts.count,z=e.watches&&e.watches.count,N=e.embeds&&e.embeds.images,j=N&&N.length>0,G=e.embeds&&e.embeds.videos&&e.embeds.videos.length>0,Y=e.embeds&&e.embeds.videos,Z=e.embeds&&e.embeds.urls&&e.embeds.urls.length>0,w=e.embeds&&e.embeds.urls,J=w&&w[w.length-1]?.openGraph?.url||"",K=e.embeds&&e.embeds.casts,Q=e.embeds&&e.embeds.casts;return r("div",{className:"not-prose farcaster-embed-container",children:[r("div",{children:[r("div",{className:"farcaster-embed-metadata",children:[a("a",{href:n,className:"farcaster-embed-avatar-link",children:a("img",{src:i.pfp.url,alt:`@${i.username}`,width:48,height:48,className:"farcaster-embed-author-avatar"})}),r("div",{className:"farcaster-embed-author",children:[a("p",{className:"farcaster-embed-author-display-name",children:i.displayName}),r("p",{className:"farcaster-embed-author-username",children:["@",i.username]})]}),a("div",{className:"farcaster-embed-timestamp",children:a("p",{title:y,children:h})})]}),r("div",{className:"farcaster-embed-body",children:[a(D,{as:"p",options:B,children:ee(e.text,J)}),j&&a(C,{images:N}),G&&a(V,{videos:Y,client:s}),Z&&a("div",{className:"farcaster-embed-urls-container",children:w.map((o,L)=>{let{description:b,domain:c,image:f,title:v,url:k,useLargeImage:X}=o.openGraph||{},q=c==="twitter.com"||c==="t.co"||c==="x.com";return c==="warpcast.com"?null:X?r("a",{href:k,target:"_blank",className:"farcaster-embed-url-link",children:[f&&a("img",{src:f,alt:v,className:"farcaster-embed-url-image"}),r("span",{className:"farcaster-embed-url-metadata",children:[a("span",{className:"farcaster-embed-url-title",children:v}),b&&a("span",{className:"farcaster-embed-url-description",children:b}),c&&a("span",{className:"farcaster-embed-url-domain",children:c})]})]},L):r("a",{href:k,target:"_blank",className:"farcaster-embed-url-link farcaster-embed-url-link-compact",children:[f&&!q&&a("img",{src:f,alt:v,className:"farcaster-embed-url-image"}),r("span",{className:"farcaster-embed-url-metadata",children:[a("span",{className:"farcaster-embed-url-title",children:v}),b&&a("span",{className:"farcaster-embed-url-description",children:b}),c&&a("span",{className:"farcaster-embed-url-domain",children:c})]})]},L)})}),K&&a("div",{className:"farcaster-embed-quote-cast-container",children:Q.map(o=>{let b=new Date(o.timestamp).toLocaleString(t.timestampLocale,t.timestampFormat),c=o.embeds&&o.embeds.images&&o.embeds.images.length>0,f=o.embeds&&o.embeds.images,v=o.embeds&&o.embeds.videos&&o.embeds.videos.length>0,k=o.embeds&&o.embeds.videos;return r("div",{className:"farcaster-embed-quote-cast",children:[r("div",{className:"farcaster-embed-metadata",children:[a("div",{className:"farcaster-embed-avatar-link",children:a("img",{src:o.author.pfp.url,alt:`@${o.author.username}`,width:20,height:20,className:"farcaster-embed-author-avatar"})}),r("div",{className:"farcaster-embed-author",children:[a("p",{className:"farcaster-embed-author-display-name",children:o.author.displayName}),r("p",{className:"farcaster-embed-author-username",children:["@",o.author.username]})]}),a("div",{className:"farcaster-embed-timestamp",children:a("p",{children:b})})]}),r("div",{className:"farcaster-embed-body",children:[a(D,{as:"p",options:B,children:o.text}),c&&a(C,{images:f}),v&&a(V,{videos:k})]})]},o.hash)})})]}),e.tags.length>0&&a("div",{children:r("div",{className:"farcaster-embed-channel",children:[e.tags[0].imageUrl&&a("img",{src:e.tags[0].imageUrl,alt:e.tags[0].name,width:16,height:16,className:"farcaster-embed-channel-avatar"}),e.tags[0].name&&a("p",{className:"farcaster-embed-channel-name",children:e.tags[0].name})]})})]}),r("div",{className:"farcaster-embed-stats",children:[r("ul",{children:[a("li",{children:r("a",{className:"farcaster-embed-stats-link",href:d,target:"_blank",children:[a(U,{}),a("span",{children:g.toLocaleString("en-US")})]})}),a("li",{children:r("a",{className:"farcaster-embed-stats-link",href:d,target:"_blank",children:[a(H,{}),a("span",{children:l.toLocaleString("en-US")})]})}),a("li",{children:r("a",{className:"farcaster-embed-stats-link",href:d,target:"_blank",children:[a(M,{}),a("span",{children:p.toLocaleString("en-US")})]})}),a("li",{children:r("a",{className:"farcaster-embed-stats-link",href:d,target:"_blank",children:[a(_,{}),a("span",{children:z.toLocaleString("en-US")})]})})]}),a("div",{className:"farcaster-embed-warpcast-icon",children:a("a",{href:d,title:"Show on Warpcast",target:"_blank",className:"farcaster-embed-warpcast-link",children:a(F,{})})})]})]})}var A={timestampFormat:{year:"numeric",month:"short",day:"numeric"},timestampLocale:"en-US"};import{jsx as ae}from"react/jsx-runtime";async function Se({url:e,username:s,hash:t,castData:i,options:n}){if(e){let h=e.split("/");s=h[3],t=h[4]}if(!i&&(!s||!t))throw new Error("You must provide a Warpcast URL or username and hash to embed a cast. Or provide your own castData to render the component.");let u=i??await $(s,t,{customEndpoint:n?.customEndpoint});return ae(T,{cast:u,options:{...A,...n}})}export{Se as FarcasterEmbed};
//# sourceMappingURL=index.mjs.map